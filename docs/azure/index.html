<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Cloud Carbon Footprint Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Cloud Carbon Footprint Blog Atom Feed"><title data-react-helmet="true">Azure | Cloud Carbon Footprint</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Azure | Cloud Carbon Footprint"><meta data-react-helmet="true" name="description" content="Your Microsoft Azure account needs to have an App registered and Service Principal with permissions to read billing and usage data from your Subscriptions"><meta data-react-helmet="true" property="og:description" content="Your Microsoft Azure account needs to have an App registered and Service Principal with permissions to read billing and usage data from your Subscriptions"><meta data-react-helmet="true" property="og:url" content="https://cloud-carbon-footprint.github.io/docs/azure"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://cloud-carbon-footprint.github.io/docs/azure"><link rel="stylesheet" href="/styles.27db0c38.css">
<link rel="preload" href="/styles.ff841748.js" as="script">
<link rel="preload" href="/runtime~main.7eabadaf.js" as="script">
<link rel="preload" href="/main.277fd307.js" as="script">
<link rel="preload" href="/1.d18285e0.js" as="script">
<link rel="preload" href="/2.42935c7b.js" as="script">
<link rel="preload" href="/01a85c17.e79d1220.js" as="script">
<link rel="preload" href="/1be78505.ca535641.js" as="script">
<link rel="preload" href="/6875c492.42cdf559.js" as="script">
<link rel="preload" href="/a6aa9e1f.4eb8fdcd.js" as="script">
<link rel="preload" href="/c4f5d8e4.2fe25849.js" as="script">
<link rel="preload" href="/ccc49370.dfca2df4.js" as="script">
<link rel="preload" href="/50.9ac25116.js" as="script">
<link rel="preload" href="/49.01346aa3.js" as="script">
<link rel="preload" href="/935f2afb.1d10943d.js" as="script">
<link rel="preload" href="/17896441.88254399.js" as="script">
<link rel="preload" href="/817d3904.41b7d909.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Cloud Carbon Footprint</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://demo.cloudcarbonfootprint.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__link">Demo</a><a class="navbar__item navbar__link navbar__link" href="/docs/getting-started">Get Started</a><a class="navbar__item navbar__link navbar__link" href="/docs/overview">Docs</a><a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__link">Github</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk" style="margin-left:1px">üåô</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk" style="margin-left:1px">‚òÄÔ∏è</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Cloud Carbon Footprint</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://demo.cloudcarbonfootprint.org/" target="_blank" rel="noopener noreferrer" class="menu__link navbar__link">Demo</a></li><li class="menu__list-item"><a class="menu__link navbar__link" href="/docs/getting-started">Get Started</a></li><li class="menu__list-item"><a class="menu__link navbar__link" href="/docs/overview">Docs</a></li><li class="menu__list-item"><a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint" target="_blank" rel="noopener noreferrer" class="menu__link navbar__link">Github</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Cloud Carbon Footprint</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">How It Works</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/methodology">Methodology</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/classifying-usage-types">Classifying Usage Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/embodied-emissions">Embodied Emissions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/on-premise">On-Premise</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Running Locally</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/create-app">Create an App</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/run-with-mocked-data">Run with Mocked Data</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Connect to Real Data</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/aws">AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/gcp">GCP</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/azure">Azure</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/alternative-data-approaches">Alternative Data Approaches</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/get-recommendations">Get Recommendations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/run-with-docker">Run with Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/running-the-cli">Running the CLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/creating-a-lookup-table">Creating a Lookup Table</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Configuration Options</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/performance-considerations">Performance Considerations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/configurations-glossary">Configurations Glossary</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/deploying">Deploying</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Integrations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/backstage-plugins">Backstage Plugins</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Azure</h1></header><div class="markdown"><p>Your Microsoft Azure account needs to have an App registered and Service Principal with permissions to read billing and usage data from your Subscriptions</p><ol><li><p>Register a new Azure Application via your Azure Portal, under ‚ÄúApp Registrations‚Äù.</p><ul><li>You do not need to set a Redirect URI or configure platform Settings. Learn more about how to do this <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app" target="_blank" rel="noopener noreferrer">here.</a></li></ul></li><li><p>Within this application, go to ‚ÄúCertificates and secrets‚Äù, and create a new Client secret.</p><ul><li>For the next step, you will need to know the client id, client secret and your tenant id.</li></ul></li><li><p>Give permissions to this application to access subscriptions:</p><ul><li>Learn more about how to do this <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal#assign-a-role-to-the-application" target="_blank" rel="noopener noreferrer">here.</a></li></ul></li><li><p>Configure environmental variables for the api and client.</p><ul><li><p>After configuring your credentials, we need to set a number of environmental variables in the app, so it can authenticate with AWS. We use .env files to manage this. Reference <a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint/blob/trunk/packages/api/.env.template" target="_blank" rel="noopener noreferrer">packages/api/.env.template</a> for a template .env file. Rename this file as .env, optionally remove the comments and then set the environment variables for the ‚ÄúBilling Data‚Äù approach. If you are only using one of these cloud providers, you can remove the environment variables associated with the other cloud provider in your <code>packgages/api/.env</code> file.</p></li><li><p>There is also a <code>packages/client/.env</code> file that allows you to set some configuration for the data range the application requests data for. See <a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint/blob/trunk/packages/client/.env.template" target="_blank" rel="noopener noreferrer">client/.env.template</a> for a template. Rename this file as .env, optionally remove the comments and then set the environment variables.</p></li><li><p>By default, the client uses AWS, GCP and Azure. If you are only using one of these cloud providers, please update the <code>appConfig</code> object in the <a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint/blob/trunk/packages/client/src/Config.ts" target="_blank" rel="noopener noreferrer">client Config file</a> to only include your provider in the <code>CURRENT_PROVIDERS</code> array.</p></li></ul></li><li><p>Finally, start up the application:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">yarn start</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></li></ol><p>‚ö†Ô∏è This will incur some cost. Use this sparingly if you wish to test with live data.</p><p>DISCLAIMER: If your editor of choice is VS Code, we recommend using either your native or custom terminal of choice (i.e. iterm) instead. Unexpected authentication issues have occurred when starting up the server in VS Code terminals.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="unsupported-usage-types"></a>Unsupported Usage Types<a class="hash-link" href="#unsupported-usage-types" title="Direct link to heading">#</a></h3><p>The application has a file containing supported usage types located <a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint/blob/trunk/packages/azure/src/lib/ConsumptionTypes.ts" target="_blank" rel="noopener noreferrer">here</a>. The current lists consist of types the application has faced, so there are likely to be some types not yet handled. When querying your data, you may come across unsupported types with a warning like this:</p><p><code>2021-03-31T09:48:38.815Z [ConsumptionManagement] warn: Unexpected usage type for storage service: LRS Snapshots</code></p><p>If you come across a similar warning message, congratulations! You have found a usage type that the app currently isn‚Äôt aware of - this is a great opportunity for you to improve Cloud Carbon Footprint!</p><p>The steps to resolve are:</p><ol><li>Determine the type in question based on the warning message</li><li>Add the type to the respective list in the <code>ConsumptionTypes.ts</code> file</li><li>Delete <code>estimates.cache.json</code> file and restart the application server</li><li>Submit an issue or pull request with the update</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="options-for-azure-authentication"></a>Options for Azure Authentication<a class="hash-link" href="#options-for-azure-authentication" title="Direct link to heading">#</a></h3><p>By default, the application authenticates with Azure using environment variables set in the api/.env file. However, if you want to store these secrets is Google Secrets Manager we also provide that option, if you want to set the AZURE_AUTH_MODE environment variable to ‚ÄúGCP‚Äù.</p><p>The authentication mode is set inside <a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint/blob/trunk/packages/common/src/Config.ts" target="_blank" rel="noopener noreferrer">packages/common/src/Config.ts</a>, and you can see these options being used in <a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint/blob/trunk/packages/azure/src/application/AzureCredentialsProvider.ts" target="_blank" rel="noopener noreferrer">packages/azure/src/application/AzureCredentialsProvider.ts</a>.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/gcp"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ GCP</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/alternative-data-approaches"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Alternative Data Approaches ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#unsupported-usage-types" class="table-of-contents__link">Unsupported Usage Types</a></li><li><a href="#options-for-azure-authentication" class="table-of-contents__link">Options for Azure Authentication</a></li></ul></div></div></div></div></main></div></div><div><section id="have-a-question"><div class="footerImageContainer_2H1A"><div><h2 class="footerImageTitle_1-0Q">Have a Question?</h2><a href="https://groups.google.com/g/cloud-carbon-footprint" target="_blank" rel="noopener noreferrer"><button class="MuiButtonBase-root MuiButton-root jss2 MuiButton-contained" tabindex="0" type="button"><span class="MuiButton-label">JOIN OUR DISCUSSION FORUM</span></button></a></div></div></section><div class="footerLicenseContainer_dmmY"><p>Cloud Carbon Footprint is an open-source project, sponsored by Thoughtworks Inc. under the¬†<a class="footerLicenseLink_jTO1" target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a></p><p><a class="footerLicenseLink_jTO1" target="_blank" href="https://www.thoughtworks.com/privacy-policy">PRIVACY POLICY</a></p></div></div></div>
<script src="/styles.ff841748.js"></script>
<script src="/runtime~main.7eabadaf.js"></script>
<script src="/main.277fd307.js"></script>
<script src="/1.d18285e0.js"></script>
<script src="/2.42935c7b.js"></script>
<script src="/01a85c17.e79d1220.js"></script>
<script src="/1be78505.ca535641.js"></script>
<script src="/6875c492.42cdf559.js"></script>
<script src="/a6aa9e1f.4eb8fdcd.js"></script>
<script src="/c4f5d8e4.2fe25849.js"></script>
<script src="/ccc49370.dfca2df4.js"></script>
<script src="/50.9ac25116.js"></script>
<script src="/49.01346aa3.js"></script>
<script src="/935f2afb.1d10943d.js"></script>
<script src="/17896441.88254399.js"></script>
<script src="/817d3904.41b7d909.js"></script>
</body>
</html>