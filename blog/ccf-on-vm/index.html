<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Running and Deploying CCF in a Virtual Machine | Cloud Carbon Footprint</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://cloud-carbon-footprint.github.io/blog/ccf-on-vm"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Running and Deploying CCF in a Virtual Machine | Cloud Carbon Footprint"><meta data-rh="true" name="description" content="Since the launch of Cloud Carbon Footprint (CCF), our team always aimed to maintain and develop flexibility in both how the tool is used and the options for its deployment. With such a large variety of infrastructure across organizations, we strive to balance supporting as many environments out of the box as possible while also preserving the customization options you may need."><meta data-rh="true" property="og:description" content="Since the launch of Cloud Carbon Footprint (CCF), our team always aimed to maintain and develop flexibility in both how the tool is used and the options for its deployment. With such a large variety of infrastructure across organizations, we strive to balance supporting as many environments out of the box as possible while also preserving the customization options you may need."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-08-23T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/4upz"><meta data-rh="true" property="article:tag" content="thoughtworks,deployment"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://cloud-carbon-footprint.github.io/blog/ccf-on-vm"><link data-rh="true" rel="alternate" href="https://cloud-carbon-footprint.github.io/blog/ccf-on-vm" hreflang="en"><link data-rh="true" rel="alternate" href="https://cloud-carbon-footprint.github.io/blog/ccf-on-vm" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://L8RY6HBDJZ-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Cloud Carbon Footprint RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Cloud Carbon Footprint Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Cloud Carbon Footprint" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.c3e29cd2.css">
<link rel="preload" href="/assets/js/runtime~main.6ae563cd.js" as="script">
<link rel="preload" href="/assets/js/main.8fe9b0da.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Cloud Carbon Footprint</b></a><a class="navbar__item navbar__link navbar__link" href="/docs/getting-started">Get Started</a><a class="navbar__item navbar__link navbar__link" href="/docs/">Docs</a><a href="https://demo.cloudcarbonfootprint.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__link">Demo</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar__link">Github</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/on-prem-data-collection">CCF Data Collection: On-Premise</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/ccf-on-vm">Running and Deploying CCF in a Virtual Machine</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Running and Deploying CCF in a Virtual Machine</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-08-23T00:00:00.000Z" itemprop="datePublished">August 23, 2023</time> ¬∑ <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/4upz" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/4upz.png" alt="Arik Smith"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/4upz" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Arik Smith</span></a></div><small class="avatar__subtitle" itemprop="description">Senior Software Engineer @ Thoughtworks</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Since the launch of Cloud Carbon Footprint (CCF), our team always aimed to maintain and develop flexibility in both how the tool is used and the options for its deployment. With such a large variety of infrastructure across organizations, we strive to balance supporting as many environments out of the box as possible while also preserving the customization options you may need.</p><p>One of the most popular options for both piloting a CCF instance as a proof of concept as well as for an internal production environment is to run CCF within a virtual machine. After all, it is a great way to get your feet wet with CCF without bringing extra dependencies on your local machine, tying up any resources, and enabling options for an always-on service that expands beyond your local machine. Alternatively, you may want to get creative by customizing or automating how CCF fits into your use cases. For example, perhaps you may want to set up a cloud function that automatically fetches cloud estimates for every recent day, week, or month? Or maybe you want a fully accessible CCF API for members of your organization or team to query? If any of these benefits sound appealing then the VM option might be for you, and you‚Äôre in the right place!</p><p>Virtual machines come in many shapes and sizes across different cloud provider platforms, including AWS EC2, Google Cloud Compute Engine, and Azure Virtual Machine services. For the sake of this article, we‚Äôll be focusing on how to create a CCF application running on an AWS EC2 instance. However, depending on the chosen operating system or distribution of your machine, the steps should be relatively the same!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-your-ec2-instance">Creating your EC2 Instance<a href="#creating-your-ec2-instance" class="hash-link" aria-label="Direct link to Creating your EC2 Instance" title="Direct link to Creating your EC2 Instance">‚Äã</a></h2><p>CCF at its core is a Node application running Express.JS for its API and React for its client. So once you have the environment setup for one endpoint of the application, you‚Äôll be able to run instances of CCF‚Äôs API, CLI, and Client on the same machine, and switch between them if desired. Before we do that, let‚Äôs create our machine and set up our environment.</p><p>To start, we assume that you already have the following:</p><ul><li>An existing AWS account with permissions for creating and managing EC2 instances</li><li>Followed the steps for setting up billing data for your <a href="https://www.cloudcarbonfootprint.org/docs/aws" target="_blank" rel="noopener noreferrer">cloud provider</a> (i.e. AWS steps 1-3)</li><li>Basic familiarity with navigating the AWS console</li></ul><p>Let‚Äôs navigate to the EC2 dashboard and select the option to launch a new instance using the shiny ‚ÄúLaunch Instances‚Äù button:</p><p><img loading="lazy" alt="Launch Instances Button" src="/assets/images/ccf_vm_blog_img_1-7fc64f56cfe5140c428efc9a8eda2b4b.png" width="1319" height="68" class="img_ev3q"></p><p>From this point, we‚Äôll be selecting the configuration options for our new machine. While the free tier may be tempting, we‚Äôll go with a t2.medium. I‚Äôve found that on smaller instances such as a t2.micro, the limited hardware can sometimes cause issues when installing node modules or running the app. So we could use the extra ‚Äúoomph‚Äù. However, for the sake of your own instance, please consider the following:</p><ul><li>If you‚Äôre expecting a large amount of estimates, consider a larger instance with higher memory and compute power.</li><li>If you plan on running a <a href="https://www.cloudcarbonfootprint.org/docs/data-persistence-and-caching#mongodb-storage" target="_blank" rel="noopener noreferrer">MongoDB instance</a> on the same machine and persisting a large amount of estimates, consider increasing the storage capacity of your instance.</li><li>If costs and efficiency is top of mind, consider choosing the option for an ARM instance as you will not be able to migrate from a non-ARM instance afterwards.</li><li>Running EC2 instances incur costs! So make sure to stop/delete instances when done with them and that you choose a capable instance that fits within your budget.</li></ul><p><img loading="lazy" alt="Launch Instances Config" src="/assets/images/ccf_vm_blog_img_2-9e297cb0fc5f23365fc19ccb50817536.png" width="863" height="636" class="img_ev3q"></p><p>You may also notice that we‚Äôll be going with an Ubuntu image as our operating system ‚Äì a popular and widely accepted distribution that you can use with any VM host. You‚Äôre welcome to choose a different Linux-based operating system such as Amazon Linux in the case of an EC2 instance. Amazon Linux serves as a Linux distribution optimized for running in AWS. It is also optimized for running most Linux-based software making the steps you‚Äôll follow almost identical. For the sake of keeping this tutorial a little more friendly for other cloud VM services, we‚Äôll be sticking with Ubuntu.</p><p>After making some final decisions in creating a key pair (required for connecting via an SSH client) and choosing a security group, we‚Äôre going to hit the even more shiny ‚ÄúLaunch Instance‚Äù button. After a short wait, you should see a notification that the instance has been created and is running. So let‚Äôs connect to it!</p><p><em>Side Note</em>: If you‚Äôre more comfortable with the <a href="https://aws.amazon.com/cli/" target="_blank" rel="noopener noreferrer">cloud provider CLI</a> or other ways of configuring resources, these steps can be replicated using those methods as well.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setting-up-your-ccf-instance">Setting Up Your CCF Instance<a href="#setting-up-your-ccf-instance" class="hash-link" aria-label="Direct link to Setting Up Your CCF Instance" title="Direct link to Setting Up Your CCF Instance">‚Äã</a></h2><p>Connect to your instance using your preferred method ‚Äì whether it be in the cloud provider console or through a local terminal via SSH. Once you‚Äôre in, we will need to configure NPM and Node so that our server can support CCF‚Äôs code.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-nodejs">Installing Node.JS<a href="#installing-nodejs" class="hash-link" aria-label="Direct link to Installing Node.JS" title="Direct link to Installing Node.JS">‚Äã</a></h3><p>We‚Äôll be following the officially recommended steps for <a href="https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/setting-up-node-on-ec2-instance.html" target="_blank" rel="noopener noreferrer">setting up Node.JS on an EC2 Instance</a>. Henceforth, we will be relying on NVM to make this an easy process! <a href="https://www.bing.com/search?pglt=641&amp;q=nvm&amp;cvid=ef35fe5448b345eba7740e8aae9b0b8e&amp;aqs=edge..69i57j0l5j69i61l3.383j0j1&amp;FORM=ANNTA1&amp;PC=U531" target="_blank" rel="noopener noreferrer">NVM</a> will manage our versions of Node for us, making migrating or downgrading easier.</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.5/install.sh | bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We then need to activate NVM by running the following command:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">. ~/.nvm/nvm.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can verify that it is active by running <code>nvm -v</code> in which you should see an output of <code>0.39.5</code> or similar.</p><p>CCF requires NodeJS 16 or later. While I prefer 18 since it is the current LTS release, you will need to run the following command ‚Äì replacing the number with the version that you wish to install:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">nvm install 18</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Note</em>: Make sure to check the latest version compatibility that your image supports. For example, Amazon Linux 2 does not support Node 18 at the time of writing this article.</p><p>NVM will also inform you that it is setting the current version as the default. This is useful for whenever you need to switch node versions or have node disabled for some reason, as you can use <code>nvm use ‚Äìdefault</code> to re-enable it. You can verify that Node is successfully installed by running <code>node -v</code>, in which you should see an output of the version that you installed.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-yarn">Installing Yarn<a href="#installing-yarn" class="hash-link" aria-label="Direct link to Installing Yarn" title="Direct link to Installing Yarn">‚Äã</a></h3><p>While installing node also automatically installs npm, CCF uses <a href="https://v3.yarnpkg.com/" target="_blank" rel="noopener noreferrer">Yarn</a> as its package manager. Fortunately, Node 16 and up make it super easy to install thanks to its inclusion of <a href="https://github.com/nodejs/corepack" target="_blank" rel="noopener noreferrer">corepack</a>.</p><p>To install Yarn, we simply need to enable corepack using the following command:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">corepack enable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With a little magic, you can now use <code>yarn -v</code> to verify that yarn is now installed and enabled in your server. You‚Äôll see that version 1 (yarn classic) is enabled. If you‚Äôve been reading the CCF documentation, you may notice that it requires Yarn 3. Do not fear, CCF will take care of the upgrade during its installation.</p><p>Now for the fun part!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="installing-ccf">Installing CCF<a href="#installing-ccf" class="hash-link" aria-label="Direct link to Installing CCF" title="Direct link to Installing CCF">‚Äã</a></h3><p>There are multiple ways to install CCF, as noted in the <a href="https://www.cloudcarbonfootprint.org/docs/getting-started" target="_blank" rel="noopener noreferrer">Getting Started</a> section. While you can clone the app and get full access to all of its packages and latest features as soon as they are available, we‚Äôre going to go with the <a href="https://www.cloudcarbonfootprint.org/docs/create-app" target="_blank" rel="noopener noreferrer">Create App</a> option as the more stable and simple solution.</p><p>To get started, we will run the create-app command with an additional flag to note that we wish to skip the <code>yarn install</code> step. This gives us flexibility in case we wish to connect our data using the <a href="https://www.cloudcarbonfootprint.org/docs/getting-started#guided-install" target="_blank" rel="noopener noreferrer">guided install</a> process, which will end up doing the installation step for us.:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">npx @cloud-carbon-footprint/create-app --skip-install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You‚Äôll be asked to install the latest version of the <code>create-app</code> package, in which you can reply ‚Äúyes‚Äù.</p><p><img loading="lazy" alt="Name Create App" src="/assets/images/ccf_vm_blog_img_3-83fab40b1161b84dd7c91f076f706d56.png" width="715" height="123" class="img_ev3q"></p><p>When prompted for a name, feel free to choose whichever name you prefer your app to have. In this example we‚Äôll be going <code>my-ccf-app</code>. Take note that this will also be the name of the directory that the app will be created in. So you may want to make sure the name is unique and matches any folder naming conventions you may have.</p><p>Afterwards, you‚Äôll see that the script takes care of creating your files and moving them to a directory named after your app. Your app will be successfully created!</p><p><img loading="lazy" alt="Create App Successful" src="/assets/images/ccf_vm_blog_img_4-37e060049caf9fbb23067239b8191aaa.png" width="722" height="117" class="img_ev3q"></p><p>Use <code>cd my-ccf-app</code> to switch to the directory of your app. You should see the following contents within your directory:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">lerna.json  package.json  packages  tsconfig.json</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Note</em>: If you run <code>yarn -v</code> again while in the directory, you‚Äôll see that the version has automatically updated to 3.1.1 like magic. ‚ú®</p><p>At this moment, you can either connect your data by manually creating a <code>.env</code> file in either your <code>packages/api</code> or <code>packages/cli</code> directory based on the <code>.env.template</code> files in those same directories. Make sure to check out the documentation on how to connect data for your chosen cloud provider:</p><ul><li><a href="https://www.cloudcarbonfootprint.org/docs/aws" target="_blank" rel="noopener noreferrer">AWS</a></li><li><a href="https://www.cloudcarbonfootprint.org/docs/gcp" target="_blank" rel="noopener noreferrer">Google Cloud</a></li><li><a href="https://www.cloudcarbonfootprint.org/docs/azure" target="_blank" rel="noopener noreferrer">Azure</a></li></ul><p>Alternatively, you can use the guided installation method mentioned above to run a friendly CLI program that will walk you through setting up your credentials and will create the <code>.env</code> files for you!</p><p>If you‚Äôd rather skip connecting your data altogether, you can also <a href="https://www.cloudcarbonfootprint.org/docs/run-with-mocked-data" target="_blank" rel="noopener noreferrer">run with mock data</a> instead and move on to the next step.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-your-app">Running Your App<a href="#running-your-app" class="hash-link" aria-label="Direct link to Running Your App" title="Direct link to Running Your App">‚Äã</a></h2><p>After following the setup method of your choice, let‚Äôs top things off by doing a <code>yarn install</code>. Once the dependencies are done installing, we‚Äôre good to <a href="https://www.cloudcarbonfootprint.org/docs/getting-started#starting-the-app" target="_blank" rel="noopener noreferrer">start our app</a>!</p><p>You can now use <code>yarn start</code> to concurrently start both the Client (react dashboard) and the API (express app).</p><ul><li>If running the client or with mock data, your CCF Dashboard will be available at port 3000 of your instance. You can view the dashboard by navigating to the public IP of your instance followed by the corresponding port.<ul><li>Please note, you will need to configure your security or network settings to make this port available</li></ul></li><li>You can also use <code>yarn start-api</code> instead to only <a href="https://www.cloudcarbonfootprint.org/docs/running-the-api" target="_blank" rel="noopener noreferrer">run the API</a>. You can verify that the API is running by making a request to one of the endpoints on port 4000 of the instance.<ul><li>For example, try making the following command in another terminal instance:<br>`curl http://[your-ip]:4000/api/regions/emissions-factors`</li><li>Please note, you will need to configure your security or network settings to make this port available if attempting to make requests outside of the instance.</li></ul></li><li>You can also use yarn <code>start-cli</code> for <a href="https://www.cloudcarbonfootprint.org/docs/running-the-cli" target="_blank" rel="noopener noreferrer">running the CLI</a> and requesting estimates directly within the terminal.</li></ul><p>Congratulations! You now have successfully created a CCF app running in a virtual machine.</p><p>You may notice that if you exit the SSH or terminal session, that the running process will not persist. In this case, you can use a tool such as a <a href="https://www.gnu.org/software/screen/" target="_blank" rel="noopener noreferrer">Screen</a> to create an uninterruptible terminal session to run your app in. To do so, try running the following command:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">screen -S ccf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will create a new Screen session called ‚Äúccf‚Äù. From here, you can run one of the <code>yarn start</code> commands to run your app and then use <code>ctrl+a</code> <code>ctrl+d</code> command keys to detach from the session. The session will stay on in the background and your CCF app will stay running!</p><p>You can always reattach to the session by entering <code>screen -r</code> in your terminal.</p><p>If you‚Äôre more comfortable and don‚Äôt like the idea of having terminal sessions running in the background, you can also create a <code>.service</code> file to <a href="https://stackoverflow.com/questions/4018154/how-do-i-run-a-node-js-app-as-a-background-service" target="_blank" rel="noopener noreferrer">run your application as a background service</a> instead.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-now">What Now?<a href="#what-now" class="hash-link" aria-label="Direct link to What Now?" title="Direct link to What Now?">‚Äã</a></h2><p>Now that you have an always-running CCF instance on a cloud-based virtual machine, you can now continue to explore both realtime and historical estimates for all of your services in the cloud. If you‚Äôd like to explore additional ways to enhance your CCF app, consider the following:</p><ul><li><a href="https://www.cloudcarbonfootprint.org/docs/run-with-docker" target="_blank" rel="noopener noreferrer">Running the CCF App with Docker</a></li><li>Creating a cron-triggered cloud function to automatically fetch new estimates</li><li>Configuring a MongoDB instance to <a href="https://www.cloudcarbonfootprint.org/docs/data-persistence-and-caching#mongodb-storage" target="_blank" rel="noopener noreferrer">persist new and historical estimate data</a></li><li>Using the CLI app to <a href="https://www.cloudcarbonfootprint.org/docs/data-persistence-and-caching#seeding-cache-file" target="_blank" rel="noopener noreferrer">seed data into the configured cache option</a> for your instance</li><li>Creating an internal dashboard for your team or organization to view estimate data</li></ul><p>Hopefully you‚Äôve found this walkthrough helpful and see that this is only the beginning of your cloud carbon footprint journey and taking steps to help create a greener cloud! For more walkthroughs and technical deep dives, make sure to keep following the <a href="http://cloudcarbonfootprint.org/blog" target="_blank" rel="noopener noreferrer">CCF Blog</a> and share your experience on our <a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint/discussions" target="_blank" rel="noopener noreferrer">discussions page</a>!</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/thoughtworks">thoughtworks</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/deployment">deployment</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/cloud-carbon-footprint/cloud-carbon-footprint/blog/2023-08-23-ccf-on-vm.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/on-prem-data-collection"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">CCF Data Collection: On-Premise</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-your-ec2-instance" class="table-of-contents__link toc-highlight">Creating your EC2 Instance</a></li><li><a href="#setting-up-your-ccf-instance" class="table-of-contents__link toc-highlight">Setting Up Your CCF Instance</a><ul><li><a href="#installing-nodejs" class="table-of-contents__link toc-highlight">Installing Node.JS</a></li><li><a href="#installing-yarn" class="table-of-contents__link toc-highlight">Installing Yarn</a></li><li><a href="#installing-ccf" class="table-of-contents__link toc-highlight">Installing CCF</a></li></ul></li><li><a href="#running-your-app" class="table-of-contents__link toc-highlight">Running Your App</a></li><li><a href="#what-now" class="table-of-contents__link toc-highlight">What Now?</a></li></ul></div></div></div></div></div><div><div class="footerLicenseContainer_aMKa"><a class="footerLicenseLink_V4Yd signature_Phj5" target="_blank" href="https://www.thoughtworks.com">Made for the üåé by Thoughtworks</a><p>Cloud Carbon Footprint is an open-source project, sponsored by Thoughtworks Inc. under the¬†<a class="footerLicenseLink_V4Yd undefined" target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a></p><p><a class="footerLicenseLink_V4Yd undefined" target="_blank" href="https://www.thoughtworks.com/privacy-policy">PRIVACY POLICY</a></p></div></div></div>
<script src="/assets/js/runtime~main.6ae563cd.js"></script>
<script src="/assets/js/main.8fe9b0da.js"></script>
</body>
</html>